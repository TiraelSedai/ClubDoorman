# üîß Phase 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (V2)

## üéØ –¶–µ–ª—å
–†–µ—à–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –ª–æ–º–∞—é—Ç —Ç–µ—Å—Ç—ã –∏ –º–µ—à–∞—é—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ, –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤.

## üìã –ü—Ä–æ–±–ª–µ–º—ã –¥–ª—è —Ä–µ—à–µ–Ω–∏—è

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞: –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ –≤ Config.cs
**–ü—Ä–æ–±–ª–µ–º–∞:** `Config.OpenRouterApi` –ø—É—Å—Ç–æ–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
- –ü—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º –∑–∞–ø—É—Å–∫–µ —Ç–µ—Å—Ç–æ–≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ –æ—á–∏—â–∞–µ—Ç—Å—è
- –õ–æ–º–∞–µ—Ç —Ç–µ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### üü° –ü—Ä–æ–±–ª–µ–º–∞: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç .env —Ñ–∞–π–ª–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç –≤ CI –±–µ–∑ .env —Ñ–∞–π–ª–∞
- –£–∂–µ —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ—à–µ–Ω–æ (—Ç–µ—Å—Ç—ã –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è)
- –ù—É–∂–Ω–æ –±–æ–ª–µ–µ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### üü° –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ async –º–µ—Ç–æ–¥—ã
**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ–ª—å—à–∏–µ –∫–ª–∞—Å—Å—ã —Å –ø—Ä–∏–≤–∞—Ç–Ω—ã–º–∏ async –º–µ—Ç–æ–¥–∞–º–∏ —Å–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
- `Worker.cs` - 8 –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö async –º–µ—Ç–æ–¥–æ–≤
- `MessageHandler.cs` - 15+ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö async –º–µ—Ç–æ–¥–æ–≤
- `CallbackQueryHandler.cs` - 9 –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö async –º–µ—Ç–æ–¥–æ–≤

### ‚úÖ –†–ï–®–ï–ù–û: –û–±—Ä–∞–±–æ—Ç–∫–∞ null-–∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥ `GetAttentionBaitProbability` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–ª null-–∞—Ä–≥—É–º–µ–Ω—Ç—ã
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ null —Å –≤—ã–±—Ä–∞—Å—ã–≤–∞–Ω–∏–µ–º `ArgumentNullException`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –º–µ—Ç–æ–¥–∞

## üõ†Ô∏è –†–µ—à–µ–Ω–∏—è

### 1. –°–æ–∑–¥–∞—Ç—å IAppConfig –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
```csharp
public interface IAppConfig
{
    string? OpenRouterApi { get; }
    bool SuspiciousDetectionEnabled { get; }
    double MimicryThreshold { get; }
    // ... –¥—Ä—É–≥–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞
}
```

### 2. –°–æ–∑–¥–∞—Ç—å AppConfig —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
```csharp
public class AppConfig : IAppConfig
{
    public string? OpenRouterApi { get; }
    public bool SuspiciousDetectionEnabled { get; }
    // ... —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
}
```

### 3. –ó–∞–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ –Ω–∞ DI
- –£–±—Ä–∞—Ç—å `Config.OpenRouterApi` –∏–∑ –∫–æ–¥–∞
- –ò–Ω–∂–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `IAppConfig` –≤ —Å–µ—Ä–≤–∏—Å—ã
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Options pattern

### 4. –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã
- –ú–æ–∫–∞—Ç—å `IAppConfig` –≤ —Ç–µ—Å—Ç–∞—Ö
- –û—á–∏—â–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏
- –£–ø—Ä–æ—Å—Ç–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Ç–µ—Å—Ç–æ–≤

## ÔøΩÔøΩ –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### ‚úÖ –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å IAppConfig –∏ AppConfig (–í–´–ü–û–õ–ù–ï–ù–û)
- [x] –°–æ–∑–¥–∞—Ç—å `IAppConfig.cs`
- [x] –°–æ–∑–¥–∞—Ç—å `AppConfig.cs`
- [x] –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –ª–æ–≥–∏–∫—É –∏–∑ `Config.cs`

### ‚úÖ –®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç—å DI —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é (–í–´–ü–û–õ–ù–ï–ù–û)
- [x] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å `IAppConfig` –≤ `Program.cs`
- [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Options pattern

### ‚úÖ –®–∞–≥ 3: –ó–∞–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ (–í–´–ü–û–õ–ù–ï–ù–û)
- [x] –ù–∞–π—Ç–∏ –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `Config.OpenRouterApi`
- [x] –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –∏–Ω–∂–µ–∫—Ç–∏—Ä—É–µ–º—ã–π `IAppConfig`
- [x] –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã

### ‚úÖ –®–∞–≥ 4: –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã (–í–´–ü–û–õ–ù–ï–ù–û)
- [x] –°–æ–∑–¥–∞—Ç—å `AppConfigTestFactory`
- [x] –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã
- [x] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### ‚úÖ –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å (–í–´–ü–û–õ–ù–ï–ù–û)
- [x] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–º–ø–∏–ª—è—Ü–∏—é
- [x] –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
- [x] **–ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ - —É–±—Ä–∞—Ç—å –≤—Å–µ —Ö–≤–æ—Å—Ç—ã –∏ –º—É—Å–æ—Ä**
- [x] –°–æ–∑–¥–∞—Ç—å –∫–æ–º–º–∏—Ç

### ‚úÖ –®–∞–≥ 6: –ò—Å–ø—Ä–∞–≤–∏—Ç—å null-–∞—Ä–≥—É–º–µ–Ω—Ç—ã (–í–´–ü–û–õ–ù–ï–ù–û)
- [x] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ null –≤ `GetAttentionBaitProbability`
- [x] –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è `ArgumentNullException`
- [x] –î–æ–±–∞–≤–∏—Ç—å XML-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
- [x] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã (593 —Ç–µ—Å—Ç–∞, 0 —Å–±–æ–µ–≤)

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ:
- ‚ùå –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ –ª–æ–º–∞—é—Ç —Ç–µ—Å—Ç—ã
- ‚ùå –°–ª–æ–∂–Ω–æ –º–æ–∫–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- ‚ùå –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç .env —Ñ–∞–π–ª–∞
- ‚ùå –ú–µ—Ç–æ–¥—ã –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–ª–∏ null-–∞—Ä–≥—É–º–µ–Ω—Ç—ã

### –ü–æ—Å–ª–µ:
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–Ω–∂–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ DI
- ‚úÖ –õ–µ–≥–∫–æ –º–æ–∫–∞—Ç—å –≤ —Ç–µ—Å—Ç–∞—Ö
- ‚úÖ –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ—á–∏—â–∞–µ—Ç—Å—è –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏
- ‚úÖ –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–≤–æ–π—Å—Ç–≤
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ null-–∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
- ‚úÖ **–ß–∏—Å—Ç—ã–π –∫–æ–¥ –±–µ–∑ —Ö–≤–æ—Å—Ç–æ–≤ –∏ –º—É—Å–æ—Ä–∞**

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞
- [x] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ (593 —Ç–µ—Å—Ç–∞, 0 —Å–±–æ–µ–≤)
- [x] –ù–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `Config.OpenRouterApi` –≤ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö
- [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω–∂–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è
- [x] Null-safety —É–ª—É—á—à–µ–Ω–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
- [x] **–ù–µ—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ –∫–æ–¥–∞**

## üîÑ –°–≤—è–∑—å —Å –¥—Ä—É–≥–∏–º–∏ —Ñ–∞–∑–∞–º–∏
- **Phase 2:** API —É–ø—Ä–æ—â–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è Phase 1)
- **Phase 3:** –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∫–ª–∞—Å—Å–æ–≤ (—Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è Phase 2)

## üìù Worklog

### 2025-01-XX - Phase 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- [x] –°–æ–∑–¥–∞–Ω IAppConfig –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- [x] –°–æ–∑–¥–∞–Ω–∞ AppConfig —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- [x] –û–±–Ω–æ–≤–ª–µ–Ω–∞ DI —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- [x] –ó–∞–º–µ–Ω–µ–Ω—ã —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ –≤ AiChecks –∏ SuspiciousCommandHandler
- [x] –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã —Å AppConfigTestFactory
- [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏—è –∏ —Ç–µ—Å—Ç—ã (593 —Ç–µ—Å—Ç–∞, 0 —Å–±–æ–µ–≤)
- [x] **–ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ - —É–¥–∞–ª—ë–Ω –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π SendWelcomeMessageRequest.cs**
- [x] –ì–æ—Ç–æ–≤ –∫ –∫–æ–º–º–∏—Ç—É

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
- [ ] –°–æ–∑–¥–∞—Ç—å –∫–æ–º–º–∏—Ç —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CI/CD pipeline
- [ ] –ü–µ—Ä–µ–π—Ç–∏ –∫ Phase 2: API —É–ø—Ä–æ—â–µ–Ω–∏–µ 