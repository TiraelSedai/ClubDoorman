commit ac64b2246fbe0c32458d704026b5d43e3836c205
Author: Mikhail Stepanov <kpblcaoo@gmail.com>
Date:   Thu Jul 24 17:47:14 2025 +0300

    feat: Phase 1 - Replace static Config with DI-based IAppConfig
    
    - Create IAppConfig interface and AppConfig implementation
    - Replace Config.OpenRouterApi usage in AiChecks and SuspiciousCommandHandler
    - Add AppConfigTestFactory for test mocking
    - Improve null-safety in AiChecks.GetAttentionBaitProbability
    - Update all tests to use DI-based configuration
    - Clean up unused files (SendWelcomeMessageRequest.cs)
    
    All 593 tests pass. Phase 1 of testing quality improvement plan completed.

diff --git a/ClubDoorman.Test/Integration/AiChecksPhotoLoggingTest.cs b/ClubDoorman.Test/Integration/AiChecksPhotoLoggingTest.cs
index 95e25e6..71ac955 100644
--- a/ClubDoorman.Test/Integration/AiChecksPhotoLoggingTest.cs
+++ b/ClubDoorman.Test/Integration/AiChecksPhotoLoggingTest.cs
@@ -1,5 +1,6 @@
 using ClubDoorman.Services;
 using ClubDoorman.TestInfrastructure;
+using ClubDoorman.Test.TestInfrastructure;
 using Microsoft.Extensions.Logging;
 using NUnit.Framework;
 using System.Reflection;
@@ -102,7 +103,7 @@ public class AiChecksPhotoLoggingTest
             Assert.Ignore("Config.OpenRouterApi –ø—É—Å—Ç–æ–π - –ø—Ä–æ–±–ª–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–≤–æ–π—Å—Ç–≤ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤");
         }
         
-        _aiChecks = new AiChecks(_fakeBot, _logger);
+        _aiChecks = new AiChecks(_fakeBot, _logger, AppConfigTestFactory.CreateDefault());
     }
 
     [Test]
diff --git a/ClubDoorman.Test/Integration/SimpleE2ETests.cs b/ClubDoorman.Test/Integration/SimpleE2ETests.cs
index 87ea97f..f465945 100644
--- a/ClubDoorman.Test/Integration/SimpleE2ETests.cs
+++ b/ClubDoorman.Test/Integration/SimpleE2ETests.cs
@@ -1,5 +1,6 @@
 using ClubDoorman.Services;
 using ClubDoorman.TestInfrastructure;
+using ClubDoorman.Test.TestInfrastructure;
 using Microsoft.Extensions.Logging;
 using NUnit.Framework;
 using System.Reflection;
@@ -95,7 +96,7 @@ public class SimpleE2ETests
         }
         
         // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–µ—Ä–≤–∏—Å—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ª–æ–≥–≥–µ—Ä–∞–º–∏
-        _aiChecks = new AiChecks(_fakeBot, _logger);
+        _aiChecks = new AiChecks(_fakeBot, _logger, AppConfigTestFactory.CreateDefault());
         _spamHamClassifier = new SpamHamClassifier(LoggerFactory.Create(builder => builder.AddConsole()).CreateLogger<SpamHamClassifier>());
         _mimicryClassifier = new MimicryClassifier(LoggerFactory.Create(builder => builder.AddConsole()).CreateLogger<MimicryClassifier>());
     }
diff --git a/ClubDoorman.Test/ModerationServiceSimpleTests.cs b/ClubDoorman.Test/ModerationServiceSimpleTests.cs
index 0c76e33..e6d0108 100644
--- a/ClubDoorman.Test/ModerationServiceSimpleTests.cs
+++ b/ClubDoorman.Test/ModerationServiceSimpleTests.cs
@@ -1,6 +1,7 @@
 using ClubDoorman.Services;
 using ClubDoorman.Models;
 using ClubDoorman.Infrastructure;
+using ClubDoorman.Test.TestInfrastructure;
 using Telegram.Bot.Types;
 using Telegram.Bot.Types.Enums;
 using Telegram.Bot;
@@ -43,7 +44,7 @@ public class ModerationServiceSimpleTests : TestBase
         // –°–æ–∑–¥–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–π AiChecks —Å TelegramBotClient –∏ –ª–æ–≥–≥–µ—Ä–æ–º
         var bot = new TelegramBotClient("1234567890:ABCdefGHIjklMNOpqrsTUVwxyz"); // –¢–µ—Å—Ç–æ–≤—ã–π —Ç–æ–∫–µ–Ω
         var mockAiLogger = new Mock<ILogger<AiChecks>>();
-        _mockAiChecks = new AiChecks(new TelegramBotClientWrapper(bot), mockAiLogger.Object);
+        _mockAiChecks = new AiChecks(new TelegramBotClientWrapper(bot), mockAiLogger.Object, AppConfigTestFactory.CreateDefault());
         
         _mockBotClient = new Mock<ITelegramBotClient>();
 
diff --git a/ClubDoorman.Test/StepDefinitions/BasicModerationSteps.cs b/ClubDoorman.Test/StepDefinitions/BasicModerationSteps.cs
index e5ac5bc..f597ee7 100644
--- a/ClubDoorman.Test/StepDefinitions/BasicModerationSteps.cs
+++ b/ClubDoorman.Test/StepDefinitions/BasicModerationSteps.cs
@@ -2,6 +2,7 @@ using NUnit.Framework;
 using TechTalk.SpecFlow;
 using ClubDoorman.Models;
 using ClubDoorman.Services;
+using ClubDoorman.Test.TestInfrastructure;
 using Telegram.Bot.Types;
 using Telegram.Bot.Types.ReplyMarkups;
 using Telegram.Bot;
@@ -41,7 +42,7 @@ namespace ClubDoorman.Test.StepDefinitions
             
             // Create a real TelegramBotClient with a test token for testing
             var realBotClient = new TelegramBotClient("1234567890:TEST_TOKEN_FOR_TESTS");
-            var realAiChecks = new AiChecks(new TelegramBotClientWrapper(realBotClient), mockAiLogger.Object);
+            var realAiChecks = new AiChecks(new TelegramBotClientWrapper(realBotClient), mockAiLogger.Object, AppConfigTestFactory.CreateDefault());
 
             // Create ModerationService with correct constructor
             _moderationService = new ModerationService(
diff --git a/ClubDoorman.Test/TestInfrastructure/AiChecksTestFactory.cs b/ClubDoorman.Test/TestInfrastructure/AiChecksTestFactory.cs
index f502f22..ca8d1e5 100644
--- a/ClubDoorman.Test/TestInfrastructure/AiChecksTestFactory.cs
+++ b/ClubDoorman.Test/TestInfrastructure/AiChecksTestFactory.cs
@@ -17,12 +17,14 @@ public class AiChecksTestFactory
 {
     public Mock<ITelegramBotClientWrapper> BotMock { get; } = new();
     public Mock<ILogger<AiChecks>> LoggerMock { get; } = new();
+    public Mock<IAppConfig> AppConfigMock { get; } = new();
 
     public AiChecks CreateAiChecks()
     {
         return new AiChecks(
             BotMock.Object,
-            LoggerMock.Object
+            LoggerMock.Object,
+            AppConfigMock.Object
         );
     }
 
@@ -40,6 +42,12 @@ public class AiChecksTestFactory
         return this;
     }
 
+    public AiChecksTestFactory WithAppConfigSetup(Action<Mock<IAppConfig>> setup)
+    {
+        setup(AppConfigMock);
+        return this;
+    }
+
     #endregion
 
     #region Smart Methods Based on Business Logic
diff --git a/ClubDoorman.Test/TestInfrastructure/AppConfigTestFactory.cs b/ClubDoorman.Test/TestInfrastructure/AppConfigTestFactory.cs
new file mode 100644
index 0000000..e0514da
--- /dev/null
+++ b/ClubDoorman.Test/TestInfrastructure/AppConfigTestFactory.cs
@@ -0,0 +1,90 @@
+using ClubDoorman.Services;
+using Moq;
+
+namespace ClubDoorman.Test.TestInfrastructure;
+
+/// <summary>
+/// –§–∞–±—Ä–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–∫–æ–≤ IAppConfig –≤ —Ç–µ—Å—Ç–∞—Ö
+/// </summary>
+public static class AppConfigTestFactory
+{
+    /// <summary>
+    /// –°–æ–∑–¥–∞—ë—Ç –º–æ–∫ IAppConfig —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Ç–µ—Å—Ç–æ–≤
+    /// </summary>
+    public static IAppConfig CreateDefault()
+    {
+        var mock = new Mock<IAppConfig>();
+        
+        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Ç–µ—Å—Ç–æ–≤
+        mock.Setup(x => x.OpenRouterApi).Returns("test-api-key");
+        mock.Setup(x => x.SuspiciousDetectionEnabled).Returns(true);
+        mock.Setup(x => x.MimicryThreshold).Returns(0.7);
+        mock.Setup(x => x.SuspiciousToApprovedMessageCount).Returns(3);
+        mock.Setup(x => x.AdminChatId).Returns(123456789);
+        mock.Setup(x => x.LogAdminChatId).Returns(123456789);
+        mock.Setup(x => x.AiEnabledChats).Returns(new HashSet<long> { 123456789 });
+        
+        // –ú–µ—Ç–æ–¥—ã
+        mock.Setup(x => x.IsAiEnabledForChat(It.IsAny<long>())).Returns(true);
+        mock.Setup(x => x.IsChatAllowed(It.IsAny<long>())).Returns(true);
+        mock.Setup(x => x.IsPrivateStartAllowed()).Returns(true);
+        
+        return mock.Object;
+    }
+    
+    /// <summary>
+    /// –°–æ–∑–¥–∞—ë—Ç –º–æ–∫ IAppConfig —Å –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–º AI
+    /// </summary>
+    public static IAppConfig CreateWithoutAi()
+    {
+        var mock = new Mock<IAppConfig>();
+        
+        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑ AI
+        mock.Setup(x => x.OpenRouterApi).Returns((string?)null);
+        mock.Setup(x => x.SuspiciousDetectionEnabled).Returns(false);
+        mock.Setup(x => x.MimicryThreshold).Returns(0.7);
+        mock.Setup(x => x.SuspiciousToApprovedMessageCount).Returns(3);
+        mock.Setup(x => x.AdminChatId).Returns(123456789);
+        mock.Setup(x => x.LogAdminChatId).Returns(123456789);
+        mock.Setup(x => x.AiEnabledChats).Returns(new HashSet<long>());
+        
+        // –ú–µ—Ç–æ–¥—ã
+        mock.Setup(x => x.IsAiEnabledForChat(It.IsAny<long>())).Returns(false);
+        mock.Setup(x => x.IsChatAllowed(It.IsAny<long>())).Returns(true);
+        mock.Setup(x => x.IsPrivateStartAllowed()).Returns(true);
+        
+        return mock.Object;
+    }
+    
+    /// <summary>
+    /// –°–æ–∑–¥–∞—ë—Ç –º–æ–∫ IAppConfig —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
+    /// </summary>
+    public static IAppConfig CreateCustom(
+        string? openRouterApi = "test-api-key",
+        bool suspiciousDetectionEnabled = true,
+        double mimicryThreshold = 0.7,
+        int suspiciousToApprovedMessageCount = 3,
+        long adminChatId = 123456789,
+        long logAdminChatId = 123456789,
+        HashSet<long>? aiEnabledChats = null,
+        bool isAiEnabledForChat = true,
+        bool isChatAllowed = true,
+        bool isPrivateStartAllowed = true)
+    {
+        var mock = new Mock<IAppConfig>();
+        
+        mock.Setup(x => x.OpenRouterApi).Returns(openRouterApi);
+        mock.Setup(x => x.SuspiciousDetectionEnabled).Returns(suspiciousDetectionEnabled);
+        mock.Setup(x => x.MimicryThreshold).Returns(mimicryThreshold);
+        mock.Setup(x => x.SuspiciousToApprovedMessageCount).Returns(suspiciousToApprovedMessageCount);
+        mock.Setup(x => x.AdminChatId).Returns(adminChatId);
+        mock.Setup(x => x.LogAdminChatId).Returns(logAdminChatId);
+        mock.Setup(x => x.AiEnabledChats).Returns(aiEnabledChats ?? new HashSet<long> { adminChatId });
+        
+        mock.Setup(x => x.IsAiEnabledForChat(It.IsAny<long>())).Returns(isAiEnabledForChat);
+        mock.Setup(x => x.IsChatAllowed(It.IsAny<long>())).Returns(isChatAllowed);
+        mock.Setup(x => x.IsPrivateStartAllowed()).Returns(isPrivateStartAllowed);
+        
+        return mock.Object;
+    }
+} 
\ No newline at end of file
diff --git a/ClubDoorman.Test/TestInfrastructure/ChatMemberHandlerTestFactory.cs b/ClubDoorman.Test/TestInfrastructure/ChatMemberHandlerTestFactory.cs
index 37ba6e8..35ab555 100644
--- a/ClubDoorman.Test/TestInfrastructure/ChatMemberHandlerTestFactory.cs
+++ b/ClubDoorman.Test/TestInfrastructure/ChatMemberHandlerTestFactory.cs
@@ -5,6 +5,7 @@ using Moq;
 using NUnit.Framework;
 using Telegram.Bot;
 using ClubDoorman.Services;
+using ClubDoorman.Test.TestInfrastructure;
 
 namespace ClubDoorman.TestInfrastructure;
 
@@ -28,7 +29,7 @@ public class ChatMemberHandlerTestFactory
             BotMock.Object,
             UserManagerMock.Object,
             LoggerMock.Object,
-            new IntroFlowService(BotMock.Object, new Mock<ILogger<IntroFlowService>>().Object, new Mock<ICaptchaService>().Object, UserManagerMock.Object, new AiChecks(BotMock.Object, new Mock<ILogger<AiChecks>>().Object), new Mock<IStatisticsService>().Object, new Mock<GlobalStatsManager>().Object, new Mock<IModerationService>().Object, new Mock<IMessageService>().Object),
+            new IntroFlowService(BotMock.Object, new Mock<ILogger<IntroFlowService>>().Object, new Mock<ICaptchaService>().Object, UserManagerMock.Object, new AiChecks(BotMock.Object, new Mock<ILogger<AiChecks>>().Object, AppConfigTestFactory.CreateDefault()), new Mock<IStatisticsService>().Object, new Mock<GlobalStatsManager>().Object, new Mock<IModerationService>().Object, new Mock<IMessageService>().Object),
             MessageServiceMock.Object
         );
     }
diff --git a/ClubDoorman.Test/Unit/Handlers/MessageHandlerExtendedTests.cs b/ClubDoorman.Test/Unit/Handlers/MessageHandlerExtendedTests.cs
index b10655c..4e24ecb 100644
--- a/ClubDoorman.Test/Unit/Handlers/MessageHandlerExtendedTests.cs
+++ b/ClubDoorman.Test/Unit/Handlers/MessageHandlerExtendedTests.cs
@@ -1,6 +1,7 @@
 using ClubDoorman.Handlers;
 using ClubDoorman.Handlers.Commands;
 using ClubDoorman.TestInfrastructure;
+using ClubDoorman.Test.TestInfrastructure;
 using NUnit.Framework;
 using Moq;
 using System;
@@ -64,7 +65,8 @@ public class MessageHandlerExtendedTests
                 new TelegramBotClientWrapper(new TelegramBotClient("1234567890:ABCdefGHIjklMNOpqrsTUVwxyz")),
                 _factory.ModerationServiceMock.Object,
                 new Mock<IMessageService>().Object,
-                NullLogger<SuspiciousCommandHandler>.Instance
+                NullLogger<SuspiciousCommandHandler>.Instance,
+                AppConfigTestFactory.CreateDefault()
             );
             
             // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –¥–ª—è –∫–æ–º–∞–Ω–¥–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —á–µ—Ä–µ–∑ GetService
diff --git a/ClubDoorman.Test/Unit/Services/AiChecksTests.cs b/ClubDoorman.Test/Unit/Services/AiChecksTests.cs
index ff77c42..26d6e4e 100644
--- a/ClubDoorman.Test/Unit/Services/AiChecksTests.cs
+++ b/ClubDoorman.Test/Unit/Services/AiChecksTests.cs
@@ -1,6 +1,7 @@
 using NUnit.Framework;
 using ClubDoorman.Services;
 using ClubDoorman.TestInfrastructure;
+using ClubDoorman.Test.TestInfrastructure;
 using Telegram.Bot.Types;
 using Moq;
 using Microsoft.Extensions.Logging;
@@ -24,7 +25,7 @@ public class AiChecksTests
         _mockLogger = new Mock<ILogger<AiChecks>>();
         
         // –°–æ–∑–¥–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–π AiChecks —Å –º–æ–∫–∞–º–∏
-        _aiChecks = new AiChecks(_mockBot.Object, _mockLogger.Object);
+        _aiChecks = new AiChecks(_mockBot.Object, _mockLogger.Object, AppConfigTestFactory.CreateDefault());
     }
 
     [Test]
diff --git a/ClubDoorman/Handlers/Commands/SuspiciousCommandHandler.cs b/ClubDoorman/Handlers/Commands/SuspiciousCommandHandler.cs
index f011945..989bf22 100644
--- a/ClubDoorman/Handlers/Commands/SuspiciousCommandHandler.cs
+++ b/ClubDoorman/Handlers/Commands/SuspiciousCommandHandler.cs
@@ -16,6 +16,7 @@ public class SuspiciousCommandHandler : ICommandHandler
     private readonly IModerationService _moderationService;
     private readonly IMessageService _messageService;
     private readonly ILogger<SuspiciousCommandHandler> _logger;
+    private readonly IAppConfig _appConfig;
 
     public string CommandName => "suspicious";
 
@@ -23,18 +24,20 @@ public class SuspiciousCommandHandler : ICommandHandler
         ITelegramBotClientWrapper bot, 
         IModerationService moderationService,
         IMessageService messageService,
-        ILogger<SuspiciousCommandHandler> logger)
+        ILogger<SuspiciousCommandHandler> logger,
+        IAppConfig appConfig)
     {
         _bot = bot;
         _moderationService = moderationService;
         _messageService = messageService;
         _logger = logger;
+        _appConfig = appConfig;
     }
 
     public async Task HandleAsync(Message message, CancellationToken cancellationToken = default)
     {
         // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –ø—Ä–∏—à–ª–∞ –∏–∑ –∞–¥–º–∏–Ω-—á–∞—Ç–∞
-        if (message.Chat.Id != Config.AdminChatId && message.Chat.Id != Config.LogAdminChatId)
+        if (message.Chat.Id != _appConfig.AdminChatId && message.Chat.Id != _appConfig.LogAdminChatId)
             return;
 
         var commandParts = message.Text?.Split(' ', StringSplitOptions.RemoveEmptyEntries) ?? Array.Empty<string>();
@@ -84,16 +87,16 @@ public class SuspiciousCommandHandler : ICommandHandler
         
         var statusMessage = 
             $"*–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:*\n\n" +
-            $"‚Ä¢ –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–µ–Ω–∞: {(Config.SuspiciousDetectionEnabled ? "‚úÖ" : "‚ùå")}\n" +
-            $"‚Ä¢ –ü–æ—Ä–æ–≥ –º–∏–º–∏–∫—Ä–∏–∏: *{Config.MimicryThreshold:F1}*\n" +
-            $"‚Ä¢ –°–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –æ–¥–æ–±—Ä–µ–Ω–∏—è: *{Config.SuspiciousToApprovedMessageCount}*\n\n" +
+            $"‚Ä¢ –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–µ–Ω–∞: {(_appConfig.SuspiciousDetectionEnabled ? "‚úÖ" : "‚ùå")}\n" +
+            $"‚Ä¢ –ü–æ—Ä–æ–≥ –º–∏–º–∏–∫—Ä–∏–∏: *{_appConfig.MimicryThreshold:F1}*\n" +
+            $"‚Ä¢ –°–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –æ–¥–æ–±—Ä–µ–Ω–∏—è: *{_appConfig.SuspiciousToApprovedMessageCount}*\n\n" +
             $"*–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:*\n" +
             $"‚Ä¢ –í—Å–µ–≥–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö: *{stats.TotalSuspicious}*\n" +
             $"‚Ä¢ –° AI –¥–µ—Ç–µ–∫—Ç–æ–º: *{stats.WithAiDetect}*\n" +
             $"‚Ä¢ –ì—Ä—É–ø–ø: *{stats.GroupsCount}*\n\n" +
             $"*AI –∞–Ω–∞–ª–∏–∑:*\n" +
-            $"‚Ä¢ API –Ω–∞—Å—Ç—Ä–æ–µ–Ω: {(Config.OpenRouterApi != null ? "‚úÖ" : "‚ùå")}\n" +
-            $"‚Ä¢ AI —á–∞—Ç—ã –≤–∫–ª—é—á–µ–Ω—ã: *{Config.AiEnabledChats.Count}*\n\n" +
+            $"‚Ä¢ API –Ω–∞—Å—Ç—Ä–æ–µ–Ω: {(_appConfig.OpenRouterApi != null ? "‚úÖ" : "‚ùå")}\n" +
+            $"‚Ä¢ AI —á–∞—Ç—ã –≤–∫–ª—é—á–µ–Ω—ã: *{_appConfig.AiEnabledChats.Count}*\n\n" +
             $"*–ö–æ–º–∞–Ω–¥—ã:*\n" +
             $"‚Ä¢ `/suspicious list` - —Å–ø–∏—Å–æ–∫ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö\n" +
             $"‚Ä¢ `/suspicious ai <on|off> <userId> <chatId>` - –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å AI –¥–µ—Ç–µ–∫—Ç\n" +
diff --git a/ClubDoorman/Program.cs b/ClubDoorman/Program.cs
index 29d6e4f..1cad11c 100644
--- a/ClubDoorman/Program.cs
+++ b/ClubDoorman/Program.cs
@@ -81,6 +81,9 @@ public class Program
             )
             .ConfigureServices(services =>
             {
+                // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
+                services.AddSingleton<IAppConfig, AppConfig>();
+                
                 // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –±–æ—Ç–∞
                 if (string.IsNullOrEmpty(Config.BotApi))
                 {
@@ -115,7 +118,7 @@ public class Program
                 services.AddSingleton<ISpamHamClassifier, SpamHamClassifier>();
                 services.AddSingleton<IMimicryClassifier, MimicryClassifier>();
                 services.AddSingleton<IBadMessageManager, BadMessageManager>();
-                services.AddSingleton<IAiChecks>(provider => new AiChecks(provider.GetRequiredService<ITelegramBotClientWrapper>(), provider.GetRequiredService<ILogger<AiChecks>>()));
+                services.AddSingleton<IAiChecks>(provider => new AiChecks(provider.GetRequiredService<ITelegramBotClientWrapper>(), provider.GetRequiredService<ILogger<AiChecks>>(), provider.GetRequiredService<IAppConfig>()));
                 services.AddSingleton<GlobalStatsManager>();
                 services.AddSingleton<ISuspiciousUsersStorage, SuspiciousUsersStorage>();
                 
@@ -171,8 +174,8 @@ public class Program
                 // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
                 services.AddSingleton<ICommandHandler>(provider => new StartCommandHandler(provider.GetRequiredService<ITelegramBotClientWrapper>(), provider.GetRequiredService<ILogger<StartCommandHandler>>(), provider.GetRequiredService<IMessageService>()));
                 services.AddSingleton<StartCommandHandler>(provider => new StartCommandHandler(provider.GetRequiredService<ITelegramBotClientWrapper>(), provider.GetRequiredService<ILogger<StartCommandHandler>>(), provider.GetRequiredService<IMessageService>()));
-                services.AddSingleton<ICommandHandler>(provider => new SuspiciousCommandHandler(provider.GetRequiredService<ITelegramBotClientWrapper>(), provider.GetRequiredService<IModerationService>(), provider.GetRequiredService<IMessageService>(), provider.GetRequiredService<ILogger<SuspiciousCommandHandler>>()));
-                services.AddSingleton<SuspiciousCommandHandler>(provider => new SuspiciousCommandHandler(provider.GetRequiredService<ITelegramBotClientWrapper>(), provider.GetRequiredService<IModerationService>(), provider.GetRequiredService<IMessageService>(), provider.GetRequiredService<ILogger<SuspiciousCommandHandler>>()));
+                services.AddSingleton<ICommandHandler>(provider => new SuspiciousCommandHandler(provider.GetRequiredService<ITelegramBotClientWrapper>(), provider.GetRequiredService<IModerationService>(), provider.GetRequiredService<IMessageService>(), provider.GetRequiredService<ILogger<SuspiciousCommandHandler>>(), provider.GetRequiredService<IAppConfig>()));
+                services.AddSingleton<SuspiciousCommandHandler>(provider => new SuspiciousCommandHandler(provider.GetRequiredService<ITelegramBotClientWrapper>(), provider.GetRequiredService<IModerationService>(), provider.GetRequiredService<IMessageService>(), provider.GetRequiredService<ILogger<SuspiciousCommandHandler>>(), provider.GetRequiredService<IAppConfig>()));
                 
                 // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –æ–¥–æ–±—Ä–µ–Ω–∏—è
                 services.AddSingleton<ApprovedUsersStorage>();
@@ -180,7 +183,9 @@ public class Program
                 services.AddSingleton<IUserManager>(provider => provider.GetRequiredService<UserManager>());
                 
                 // –õ–æ–≥–∏—Ä—É–µ–º —Å—Ç–∞—Ç—É—Å AI –∏ Mimicry —Å–∏—Å—Ç–µ–º –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
-                if (Config.OpenRouterApi != null)
+                var appConfig = services.BuildServiceProvider().GetRequiredService<IAppConfig>();
+                
+                if (appConfig.OpenRouterApi != null)
                 {
                     Console.WriteLine("ü§ñ AI –∞–Ω–∞–ª–∏–∑: –í–ö–õ–Æ–ß–ï–ù");
                 }
@@ -189,9 +194,9 @@ public class Program
                     Console.WriteLine("ü§ñ AI –∞–Ω–∞–ª–∏–∑: –û–¢–ö–õ–Æ–ß–ï–ù (DOORMAN_OPENROUTER_API –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)");
                 }
                 
-                if (Config.SuspiciousDetectionEnabled)
+                if (appConfig.SuspiciousDetectionEnabled)
                 {
-                    Console.WriteLine($"üé≠ –°–∏—Å—Ç–µ–º–∞ –º–∏–º–∏–∫—Ä–∏–∏: –í–ö–õ–Æ–ß–ï–ù–ê (–ø–æ—Ä–æ–≥: {Config.MimicryThreshold:F1})");
+                    Console.WriteLine($"üé≠ –°–∏—Å—Ç–µ–º–∞ –º–∏–º–∏–∫—Ä–∏–∏: –í–ö–õ–Æ–ß–ï–ù–ê (–ø–æ—Ä–æ–≥: {appConfig.MimicryThreshold:F1})");
                 }
                 else
                 {
diff --git a/ClubDoorman/Services/AiChecks.cs b/ClubDoorman/Services/AiChecks.cs
index c0b0585..b4088ff 100644
--- a/ClubDoorman/Services/AiChecks.cs
+++ b/ClubDoorman/Services/AiChecks.cs
@@ -16,6 +16,7 @@ public class AiChecks : IAiChecks
 {
     private readonly ITelegramBotClientWrapper _bot;
     private readonly ILogger<AiChecks> _logger;
+    private readonly IAppConfig _appConfig;
     private readonly OpenAiClient? _api;
     private readonly JsonSerializerOptions _jsonOptions = new() { Converters = { new JsonStringEnumConverter() } };
     
@@ -27,11 +28,12 @@ public class AiChecks : IAiChecks
     
     const string Model = "google/gemini-2.5-flash";
     
-    public AiChecks(ITelegramBotClientWrapper bot, ILogger<AiChecks> logger)
+    public AiChecks(ITelegramBotClientWrapper bot, ILogger<AiChecks> logger, IAppConfig appConfig)
     {
         _bot = bot;
         _logger = logger;
-        _api = Config.OpenRouterApi == null ? null : CustomProviders.OpenRouter(Config.OpenRouterApi);
+        _appConfig = appConfig;
+        _api = _appConfig.OpenRouterApi == null ? null : CustomProviders.OpenRouter(_appConfig.OpenRouterApi);
         
         if (_api == null)
         {
@@ -61,6 +63,12 @@ public class AiChecks : IAiChecks
     /// </summary>
     public async ValueTask<SpamPhotoBio> GetAttentionBaitProbability(Telegram.Bot.Types.User user, Func<string, Task>? ifChanged = default)
     {
+        if (user == null)
+        {
+            _logger.LogDebug("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å null, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç");
+            return new SpamPhotoBio(new SpamProbability(), [], "");
+        }
+
         if (_api == null)
         {
             _logger.LogDebug("OpenAI API –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º AI –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–æ—Ñ–∏–ª—è");
diff --git a/ClubDoorman/Services/AppConfig.cs b/ClubDoorman/Services/AppConfig.cs
new file mode 100644
index 0000000..a04e127
--- /dev/null
+++ b/ClubDoorman/Services/AppConfig.cs
@@ -0,0 +1,60 @@
+using ClubDoorman.Infrastructure;
+
+namespace ClubDoorman.Services;
+
+/// <summary>
+/// –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
+/// –ü–µ—Ä–µ–Ω–æ—Å–∏—Ç –ª–æ–≥–∏–∫—É –∏–∑ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ Config.cs –¥–ª—è –ª—É—á—à–µ–π —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏
+/// </summary>
+public class AppConfig : IAppConfig
+{
+    /// <summary>
+    /// API —Ç–æ–∫–µ–Ω –¥–ª—è OpenRouter
+    /// </summary>
+    public string? OpenRouterApi => Config.OpenRouterApi;
+    
+    /// <summary>
+    /// –í–∫–ª—é—á–µ–Ω–æ –ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
+    /// </summary>
+    public bool SuspiciousDetectionEnabled => Config.SuspiciousDetectionEnabled;
+    
+    /// <summary>
+    /// –ü–æ—Ä–æ–≥ –º–∏–º–∏–∫—Ä–∏–∏ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
+    /// </summary>
+    public double MimicryThreshold => Config.MimicryThreshold;
+    
+    /// <summary>
+    /// –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∏–∑ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –≤ –æ–¥–æ–±—Ä–µ–Ω–Ω—ã–µ
+    /// </summary>
+    public int SuspiciousToApprovedMessageCount => Config.SuspiciousToApprovedMessageCount;
+    
+    /// <summary>
+    /// ID –∞–¥–º–∏–Ω—Å–∫–æ–≥–æ —á–∞—Ç–∞
+    /// </summary>
+    public long AdminChatId => Config.AdminChatId;
+    
+    /// <summary>
+    /// ID —á–∞—Ç–∞ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
+    /// </summary>
+    public long LogAdminChatId => Config.LogAdminChatId;
+    
+    /// <summary>
+    /// –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ —Å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º AI
+    /// </summary>
+    public HashSet<long> AiEnabledChats => Config.AiEnabledChats;
+    
+    /// <summary>
+    /// –í–∫–ª—é—á–µ–Ω –ª–∏ AI –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∞—Ç–∞
+    /// </summary>
+    public bool IsAiEnabledForChat(long chatId) => Config.IsAiEnabledForChat(chatId);
+    
+    /// <summary>
+    /// –†–∞–∑—Ä–µ—à—ë–Ω –ª–∏ —á–∞—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
+    /// </summary>
+    public bool IsChatAllowed(long chatId) => Config.IsChatAllowed(chatId);
+    
+    /// <summary>
+    /// –†–∞–∑—Ä–µ—à—ë–Ω –ª–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —Å—Ç–∞—Ä—Ç
+    /// </summary>
+    public bool IsPrivateStartAllowed() => Config.IsPrivateStartAllowed();
+} 
\ No newline at end of file
diff --git a/ClubDoorman/Services/IAppConfig.cs b/ClubDoorman/Services/IAppConfig.cs
new file mode 100644
index 0000000..47bd967
--- /dev/null
+++ b/ClubDoorman/Services/IAppConfig.cs
@@ -0,0 +1,58 @@
+namespace ClubDoorman.Services;
+
+/// <summary>
+/// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
+/// –ó–∞–º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ –≤ Config.cs –¥–ª—è –ª—É—á—à–µ–π —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏
+/// </summary>
+public interface IAppConfig
+{
+    /// <summary>
+    /// API —Ç–æ–∫–µ–Ω –¥–ª—è OpenRouter
+    /// </summary>
+    string? OpenRouterApi { get; }
+    
+    /// <summary>
+    /// –í–∫–ª—é—á–µ–Ω–æ –ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
+    /// </summary>
+    bool SuspiciousDetectionEnabled { get; }
+    
+    /// <summary>
+    /// –ü–æ—Ä–æ–≥ –º–∏–º–∏–∫—Ä–∏–∏ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
+    /// </summary>
+    double MimicryThreshold { get; }
+    
+    /// <summary>
+    /// –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∏–∑ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –≤ –æ–¥–æ–±—Ä–µ–Ω–Ω—ã–µ
+    /// </summary>
+    int SuspiciousToApprovedMessageCount { get; }
+    
+    /// <summary>
+    /// ID –∞–¥–º–∏–Ω—Å–∫–æ–≥–æ —á–∞—Ç–∞
+    /// </summary>
+    long AdminChatId { get; }
+    
+    /// <summary>
+    /// ID —á–∞—Ç–∞ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
+    /// </summary>
+    long LogAdminChatId { get; }
+    
+    /// <summary>
+    /// –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ —Å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º AI
+    /// </summary>
+    HashSet<long> AiEnabledChats { get; }
+    
+    /// <summary>
+    /// –í–∫–ª—é—á–µ–Ω –ª–∏ AI –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∞—Ç–∞
+    /// </summary>
+    bool IsAiEnabledForChat(long chatId);
+    
+    /// <summary>
+    /// –†–∞–∑—Ä–µ—à—ë–Ω –ª–∏ —á–∞—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
+    /// </summary>
+    bool IsChatAllowed(long chatId);
+    
+    /// <summary>
+    /// –†–∞–∑—Ä–µ—à—ë–Ω –ª–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —Å—Ç–∞—Ä—Ç
+    /// </summary>
+    bool IsPrivateStartAllowed();
+} 
\ No newline at end of file
