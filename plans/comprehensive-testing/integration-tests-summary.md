# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ API - –†–µ–∑—é–º–µ

## ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞

**–ü—Ä–æ–±–ª–µ–º–∞**: –¢–µ—Å—Ç—ã –ø—Ä–æ–ø—É—Å–∫–∞–ª–∏—Å—å –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ `.env` —Ñ–∞–π–ª–∞.

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `AppContext.BaseDirectory` –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ `.env` —Ñ–∞–π–ª–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç IDE/CLI.

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –ú–µ—Ç–æ–¥ FindEnvFile()
```csharp
private string FindEnvFile()
{
    var baseDir = AppContext.BaseDirectory;
    
    // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –ø—É—Ç–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ AppContext.BaseDirectory
    var possiblePaths = new[]
    {
        Path.Combine(baseDir, "../../../../ClubDoorman/.env"),
        Path.Combine(baseDir, "../../../ClubDoorman/.env"),
        // ... –¥—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
    };
    
    foreach (var path in possiblePaths)
    {
        if (File.Exists(path))
        {
            return path;
        }
    }
    
    throw new FileNotFoundException("Could not find .env file");
}
```

### –ü—É—Ç—å –∫ .env —Ñ–∞–π–ª—É
- `AppContext.BaseDirectory` = `/home/kpblc/projects/ClubDoorman/ClubDoorman.Test/bin/Debug/net9.0/`
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å = `../../../../ClubDoorman/.env`
- 4 —É—Ä–æ–≤–Ω—è –≤–≤–µ—Ä—Ö: `bin/Debug/net9.0/` ‚Üí `ClubDoorman.Test/` ‚Üí `ClubDoorman/` ‚Üí `.env`

## üß™ –†–∞–±–æ—Ç–∞—é—â–∏–µ —Ç–µ—Å—Ç—ã

### 1. EnvironmentTest
- **–ö–∞—Ç–µ–≥–æ—Ä–∏—è**: `integration`, `environment`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: `DOORMAN_OPENROUTER_API`, `DOORMAN_BOT_API`, `DOORMAN_ADMIN_CHAT`

### 2. AiChecksPhotoLoggingTest
- **–ö–∞—Ç–µ–≥–æ—Ä–∏—è**: `integration`, `ai-photo`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –¢–µ—Å—Ç AI –∞–Ω–∞–ª–∏–∑–∞ —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑ —Ä–µ–∞–ª—å–Ω—ã–π OpenRouter API
- **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: –ê–Ω–∞–ª–∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–ø–∞–º–∞ 0.05 (5%)

## üöÄ –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞

–°–æ–∑–¥–∞–Ω `scripts/run_integration_tests.sh`:

```bash
# –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ API
./scripts/run_integration_tests.sh

# –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç–æ–≤
dotnet test ClubDoorman.Test/ClubDoorman.Test.csproj --filter "Category!=integration"

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
./scripts/run_tests.sh
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚ùå –¢–µ—Å—Ç—ã –ø—Ä–æ–ø—É—Å–∫–∞–ª–∏—Å—å —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º "DOORMAN_OPENROUTER_API –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
- ‚ùå –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª–∏—Å—å

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ –í—Å–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –†–µ–∞–ª—å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å OpenRouter API
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ `.env` —Ñ–∞–π–ª–∞
- ‚úÖ –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ~4-5 —Å–µ–∫—É–Ω–¥ (–≤–∫–ª—é—á–∞—è API –≤—ã–∑–æ–≤—ã)

## üîë –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –Ω—É–∂–Ω—ã:
1. –§–∞–π–ª `ClubDoorman/.env` —Å API –∫–ª—é—á–∞–º–∏
2. `DOORMAN_OPENROUTER_API` - –∫–ª—é—á –¥–ª—è OpenRouter
3. `DOORMAN_BOT_API` - —Ç–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
4. `DOORMAN_ADMIN_CHAT` - ID –∞–¥–º–∏–Ω—Å–∫–æ–≥–æ —á–∞—Ç–∞

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
2. **–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `./scripts/run_integration_tests.sh`
3. **–î–ª—è CI/CD**: –î–æ–±–∞–≤—å—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—É—é job –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –°–ª–µ–¥–∏—Ç–µ –∑–∞ —Ä–∞—Å—Ö–æ–¥–æ–º API —Ç–æ–∫–µ–Ω–æ–≤ –ø—Ä–∏ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—É—Å–∫–∞—Ö

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å Telegram API
2. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –¥—Ä—É–≥–∏—Ö AI —Å–µ—Ä–≤–∏—Å–æ–≤
3. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD pipeline –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ 